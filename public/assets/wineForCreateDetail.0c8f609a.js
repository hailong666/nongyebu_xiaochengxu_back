import{d as pe,r as p,a as me,I as _e,i as x,w as a,g as m,o as C,e as u,b as n,k as f,c as V,j as ge,F as fe,h as F,B as D,u as ve,l as he,q as A,E as T,z as P,s as S,v as L,t as M,D as ye,G as Ce}from"./index.f931844d.js";import{u as O,h as Fe,f as H,i as Ie,j as be,a as K}from"./index.dadfe553.js";import{_ as ke}from"./_plugin-vue_export-helper.cdc0426e.js";const E=b=>(ye("data-v-42c63a31"),b=b(),Ce(),b),Be=["src"],Ve={class:"el-upload-list__item-actions"},De=["onClick"],Ee=["onClick"],we=["src"],Ue={class:"gui-ge"},Re={class:"guige1"},Ne={key:0,class:"guige-item"},xe=["onClick"],Ae={key:1},Pe={class:"guige-span"},Se={class:"guige2"},Le={class:"guige-input1"},Oe=["src"],Ge={class:"el-upload-list__item-actions"},Je=["onClick"],$e=["onClick"],je=["src"],qe={class:"el-upload-list__item-actions"},ze=["onClick"],Te=["onClick"],Me=E(()=>n("br",null,null,-1)),He=E(()=>n("br",null,null,-1)),Ke=E(()=>n("br",null,null,-1)),Qe=E(()=>n("br",null,null,-1)),We=pe({__name:"wineForCreateDetail",setup(b){const G=p(),J=p(),$=p(),w=p(!1),j=p(null),q=ve(),Q=he(),l=me({name:"",price:"",guigeList:[],priceInfo:"",isRecommend:!1,guigeName:"",guigePrice:"",tip:"",count:""}),k=p(""),I=p(!1),W=e=>{console.log(e),G.value.handleRemove(e);let t=v.value.findIndex(i=>i.uid==e.uid);t!=-1&&v.value.splice(t,1)},X=e=>{console.log(e),J.value.handleRemove(e);let t=_.value.findIndex(i=>i.uid==e.uid);t!=-1&&_.value.splice(t,1)},Y=e=>{console.log(e),$.value.handleRemove(e);let t=g.value.findIndex(i=>i.uid==e.uid);t!=-1&&g.value.splice(t,1)},Z=e=>{k.value=e.url,I.value=!0},ee=e=>{k.value=e.url,I.value=!0},le=e=>{k.value=e.url,I.value=!0};var v=p([]),_=p([]),g=p([]);const U=e=>{if(console.log(e),e.size>1024*600)return A({message:"\u4E0A\u4F20\u56FE\u7247\u4E0D\u80FD\u5927\u4E8E600kb",type:"error"}),!1},ue=e=>{console.log(e);const t=new FormData;t.append("pic",e.file),O(t).then(i=>{v.value.push({url:i.path,uid:e.file.uid}),console.log(v)})},te=e=>{console.log(e);const t=new FormData;t.append("pic",e.file),O(t).then(i=>{_.value.push({url:i.path,uid:e.file.uid}),console.log(_)})},oe=e=>{console.log(e);const t=new FormData;t.append("pic",e.file),O(t).then(i=>{g.value.push({url:i.path,uid:e.file.uid}),console.log(g)})},ae=()=>{l.guigeName&&l.guigePrice&&l.guigeList.push({name:l.guigeName,price:l.guigePrice})},ie=e=>{l.guigeList.splice(e,1)},d=p({}),R=function(e){return e&&e.length>0?typeof e=="string"?JSON.parse(e):e:[]},ne=()=>{if(!l.name||!v.value.length||!_.value.length||!g.value.length||!l.tip||!l.priceInfo||!l.price||!l.guigeList.length){T({title:"\u63D0\u793A",message:"\u6709\u5185\u5BB9\u4E3A\u7A7A,\u8BF7\u586B\u5168",type:"warning"});return}Fe({id:j.value,name:l.name,img:JSON.stringify(v.value.map(e=>e.url)),cover_img:JSON.stringify([..._.value.map(e=>e.url),...g.value.map(e=>e.url)]),kucun:"10000000",description:l.tip,discount_info:l.priceInfo,price:0,sale_price:l.price,sale_count:l.count,guige:JSON.stringify(l.guigeList),ctime:H(new Date),iftuijian:l.isRecommend?"1":"0"}).then(e=>{e.status==200&&A({message:"\u66F4\u65B0\u5546\u54C1\u6210\u529F",type:"success"})})},se=()=>{if(!l.name||!v.value.length||!_.value.length||!g.value.length||!l.tip||!l.priceInfo||!l.price||!l.guigeList.length){T({title:"\u63D0\u793A",message:"\u6709\u5185\u5BB9\u4E3A\u7A7A,\u8BF7\u586B\u5168",type:"warning"});return}Ie({name:l.name,img:JSON.stringify(v.value.map(e=>e.url)),cover_img:JSON.stringify([..._.value.map(e=>e.url),...g.value.map(e=>e.url)]),kucun:"10000000",description:l.tip,discount_info:l.priceInfo,price:0,sale_price:l.price,sale_count:l.count,guige:JSON.stringify(l.guigeList),ctime:H(new Date),iftuijian:l.isRecommend?"1":"0"}).then(e=>{e.status==200&&(q.back(),A({message:"\u521B\u5EFA\u5546\u54C1\u6210\u529F",type:"success"}))})};return _e(()=>Q.params.id,e=>{!e||(j.value=e,w.value=!0,be({id:e}).then(t=>{if(t.status==200){const i=t.data;i.img=R(i.img).map((c,r)=>({uid:K(),url:c})),v.value=[...i.img.map(c=>({url:c.url,uid:c.uid}))],i.cover_img=R(i.cover_img).map((c,r)=>({uid:K(),url:c}));const s=JSON.parse(JSON.stringify(i.cover_img));i.cover_img.length>1?(g.value=[{url:s[s.length-1].url,uid:s[s.length-1].uid}],_.value=[...s.slice(0,s.length-1).map(c=>({url:c.url,uid:c.uid}))],i.cover_img=s.slice(0,s.length-1),i.buyInfoImg=[s[s.length-1]]):(g.value=[],_.value=[{url:s[0].url,uid:s[0].uid}],i.cover_img=s,i.buyInfoImg=[]),i.guige=R(i.guige),d.value=i,l.name=d.value.name,l.price=d.value.sale_price,l.tip=d.value.description,l.count=d.value.sale_count,l.priceInfo=d.value.discount_info,l.guigeList=d.value.guige,l.isRecommend=!!d.value.iftuijian,console.log(d)}}))},{immediate:!0,deep:!0}),(e,t)=>{const i=m("el-icon"),s=m("el-upload"),c=m("el-dialog"),r=m("el-form-item"),y=m("el-input"),B=m("el-button"),z=m("el-radio"),de=m("el-radio-group"),N=m("el-col"),re=m("el-row"),ce=m("el-form");return C(),x(ce,{class:"my-form-cont",model:l,"label-width":"100px"},{default:a(()=>[u(r,{label:"\u9152\u56FE\u7247"},{default:a(()=>[u(s,{action:"#","list-type":"picture-card","http-request":ue,ref_key:"elUploadRef",ref:G,"file-list":d.value.img,"onUpdate:file-list":t[0]||(t[0]=o=>d.value.img=o),accept:"image/*","before-upload":U},{file:a(({file:o})=>[n("div",null,[n("img",{class:"el-upload-list__item-thumbnail",src:o.url,alt:""},null,8,Be),n("span",Ve,[n("span",{class:"el-upload-list__item-preview",onClick:h=>Z(o)},[u(i,null,{default:a(()=>[u(f(P))]),_:1})],8,De),n("span",{class:"el-upload-list__item-delete",onClick:h=>W(o)},[u(i,null,{default:a(()=>[u(f(S))]),_:1})],8,Ee)])])]),default:a(()=>[u(i,null,{default:a(()=>[u(f(L))]),_:1})]),_:1},8,["file-list"]),u(c,{modelValue:I.value,"onUpdate:modelValue":t[1]||(t[1]=o=>I.value=o)},{default:a(()=>[n("img",{style:{width:"100%"},src:k.value,alt:"Preview Image"},null,8,we)]),_:1},8,["modelValue"])]),_:1}),u(r,{label:"\u9152\u540D\u5B57"},{default:a(()=>[u(y,{modelValue:l.name,"onUpdate:modelValue":t[2]||(t[2]=o=>l.name=o)},null,8,["modelValue"])]),_:1}),u(r,{label:"\u9152\u4EF7\u683C\u8303\u56F4"},{default:a(()=>[u(y,{modelValue:l.price,"onUpdate:modelValue":t[3]||(t[3]=o=>l.price=o)},null,8,["modelValue"])]),_:1}),u(r,{label:"\u9152\u6570\u91CF"},{default:a(()=>[u(y,{modelValue:l.count,"onUpdate:modelValue":t[4]||(t[4]=o=>l.count=o)},null,8,["modelValue"])]),_:1}),u(r,{label:"\u9152\u7B80\u4ECB"},{default:a(()=>[u(y,{modelValue:l.tip,"onUpdate:modelValue":t[5]||(t[5]=o=>l.tip=o)},null,8,["modelValue"])]),_:1}),u(r,{label:"\u9152\u89C4\u683C"},{default:a(()=>[n("div",Ue,[n("div",Re,[(C(!0),V(fe,null,ge(l.guigeList,(o,h)=>(C(),V("div",{class:"guige-inner-div",key:h},[o?(C(),V("div",Ne,[n("div",null,M(o.name),1),n("span",{onClick:Xe=>ie(h)},"\xD7",8,xe)])):D("",!0),o?(C(),V("div",Ae,[n("span",Pe,"\u2003----\u2003(\uFFE5"+M(o.price)+")",1)])):D("",!0)]))),128))]),n("div",Se,[n("div",Le,[u(y,{modelValue:l.guigeName,"onUpdate:modelValue":t[6]||(t[6]=o=>l.guigeName=o),placeholder:"\u8BF7\u8F93\u5165\u89C4\u683C\u540D\u5B57"},null,8,["modelValue"])]),n("div",null,[u(y,{modelValue:l.guigePrice,"onUpdate:modelValue":t[7]||(t[7]=o=>l.guigePrice=o),placeholder:"\u8BF7\u8F93\u5165\u89C4\u683C\u4EF7\u683C"},null,8,["modelValue"])]),u(B,{class:"guige-btn",type:"primary",onClick:ae},{default:a(()=>[F("\u786E\u5B9A\u89C4\u683C")]),_:1})])])]),_:1}),u(r,{label:"\u8BE6\u60C5\u56FE\u7247"},{default:a(()=>[u(s,{action:"#","list-type":"picture-card","http-request":te,ref_key:"elUploadRefDetailImg",ref:J,"file-list":d.value.cover_img,"onUpdate:file-list":t[8]||(t[8]=o=>d.value.cover_img=o),accept:"image/*","before-upload":U},{file:a(({file:o})=>[n("div",null,[n("img",{class:"el-upload-list__item-thumbnail",src:o.url,alt:""},null,8,Oe),n("span",Ge,[n("span",{class:"el-upload-list__item-preview",onClick:h=>ee(o)},[u(i,null,{default:a(()=>[u(f(P))]),_:1})],8,Je),n("span",{class:"el-upload-list__item-delete",onClick:h=>X(o)},[u(i,null,{default:a(()=>[u(f(S))]),_:1})],8,$e)])])]),default:a(()=>[u(i,null,{default:a(()=>[u(f(L))]),_:1})]),_:1},8,["file-list"])]),_:1}),u(r,{label:"\u8D2D\u7269\u987B\u77E5"},{default:a(()=>[u(s,{action:"#","list-type":"picture-card","http-request":oe,ref_key:"elUploadRefBuyInfo",ref:$,"file-list":d.value.buyInfoImg,"onUpdate:file-list":t[9]||(t[9]=o=>d.value.buyInfoImg=o),limit:1,accept:"image/*","before-upload":U},{file:a(({file:o})=>[n("div",null,[n("img",{class:"el-upload-list__item-thumbnail",src:o.url,alt:""},null,8,je),n("span",qe,[n("span",{class:"el-upload-list__item-preview",onClick:h=>le(o)},[u(i,null,{default:a(()=>[u(f(P))]),_:1})],8,ze),n("span",{class:"el-upload-list__item-delete",onClick:h=>Y(o)},[u(i,null,{default:a(()=>[u(f(S))]),_:1})],8,Te)])])]),default:a(()=>[u(i,null,{default:a(()=>[u(f(L))]),_:1})]),_:1},8,["file-list"])]),_:1}),u(r,{label:"\u4EF7\u683C\u8BF4\u660E"},{default:a(()=>[u(y,{type:"textarea",rows:4,placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",modelValue:l.priceInfo,"onUpdate:modelValue":t[10]||(t[10]=o=>l.priceInfo=o),resize:"none"},null,8,["modelValue"])]),_:1}),u(r,{label:"\u662F\u5426\u63A8\u8350"},{default:a(()=>[u(de,{modelValue:l.isRecommend,"onUpdate:modelValue":t[11]||(t[11]=o=>l.isRecommend=o)},{default:a(()=>[u(z,{label:!0},{default:a(()=>[F("\u662F")]),_:1}),u(z,{label:!1},{default:a(()=>[F("\u5426")]),_:1})]),_:1},8,["modelValue"]),Me,He,Ke,Qe]),_:1}),u(re,{justify:"center"},{default:a(()=>[u(N,{span:3},{default:a(()=>[u(B,{onClick:t[12]||(t[12]=o=>f(q).back())},{default:a(()=>[F("\u2003\u8FD4\u56DE\u2003")]),_:1})]),_:1}),w.value?(C(),x(N,{key:0,span:3},{default:a(()=>[u(B,{type:"primary",onClick:ne},{default:a(()=>[F("\u786E\u5B9A\u4FEE\u6539")]),_:1})]),_:1})):D("",!0),w.value?D("",!0):(C(),x(N,{key:1,span:3},{default:a(()=>[u(B,{type:"primary",onClick:se},{default:a(()=>[F("\u2003\u65B0\u5EFA\u2003")]),_:1})]),_:1}))]),_:1})]),_:1},8,["model"])}}});const ll=ke(We,[["__scopeId","data-v-42c63a31"]]);export{ll as default};
